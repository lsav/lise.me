{% capture page_title %}{{ site.title }}{% if page.title %} // {{ page.title }}{% endif %}{% endcapture %}

<title>{{ page_title }}</title>
<meta name="title" content="{{ page_title }}" />
<meta property="og:title" content="{{ page_title }}" />

<meta content="width=device-width, initial-scale=1.0, user-scalable=no" name="viewport">
<meta content="text/html; charset=utf-8" http-equiv="content-type" />

<link rel="shortcut icon" href="{{ site.url }}/assets/favicon.png" />
<link rel="stylesheet" href="{{ site.url }}/assets/css/main.css" />
<link rel="apple-touch-icon" href="{{ site.url }}/assets/touchicon.png" />
<link rel="canonical" href="{{ page.url | prepend: site.url }}" />
<link rel="alternate" type="application/atom+xml" title="{{ site.title }}" href="{{ site.url }}/feed.xml" />

{% capture blurb %}{{ page.content | strip_html | strip_newlines | truncate: 120 }}{% endcapture %}
{% capture page_description %}{% if page.description %}{{ page.description }}{% elsif page.date %}{{ blurb }}{% else %}{{ site.description }}{% endif %}{% endcapture %}

<meta name="description" content="{{ page_description }}" />
<meta property="og:url" content="{{ site.url }}{{ page.url }}" />
<meta property="og:description" content="{{ page_description }}" />
<meta property="og:type" content="{% if page.date %}article{% else %}website{% endif %}" />
<meta property="og:image" content="{% if page.coverimage %}{{ page.coverimage }}{% else %}{{ site.url }}/assets/touchicon.png{% endif %}" />

<script src="//code.jquery.com/jquery-1.12.4.min.js"></script>

{% if jekyll.environment == "production" %}
<!-- google analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id={{ site.google_analytics }}"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag("js", new Date());
  gtag("config", "{{ site.google_analytics }}");
</script>
{% endif %}

{% unless page.date %}
<script>
  function printEmail() {
    /* definitely impossible-to-crack email obfustimacator */
    var chars = ",.abcdefghijklmnopqrstuvwxyz!@#$%^&*()";
    var order = [13, 10, 20, 6, 29, 13, 10, 20, 6, 1, 14, 6];
    var addr = "";
    for ( var i = 0 ; i < order.length ; i++ ) {
      addr += chars[order[i]];
    }
    document.write("<a href='mailto:"+addr+"'>"+addr+"</a>");  
  }
</script>
{% endunless %}
